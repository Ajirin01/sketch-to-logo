from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D, Conv2DTranspose, LeakyReLU, BatchNormalization, Input

def create_model():
    model = Sequential([
        Input(shape=(224, 224, 1)),  # Specify input shape
        Conv2D(64, (3, 3), padding='same'),
        LeakyReLU(negative_slope=0.2),
        BatchNormalization(),
        Conv2D(128, (3, 3), padding='same'),
        LeakyReLU(negative_slope=0.2),
        BatchNormalization(),
        Conv2D(256, (3, 3), padding='same'),
        LeakyReLU(negative_slope=0.2),
        BatchNormalization(),
        
        Conv2DTranspose(128, (3, 3), padding='same'),
        LeakyReLU(negative_slope=0.2),
        BatchNormalization(),
        Conv2DTranspose(64, (3, 3), padding='same'),
        LeakyReLU(negative_slope=0.2),
        BatchNormalization(),
        Conv2D(10, (3, 3), padding='same', activation='sigmoid')
    ])
    return model

model = create_model()
model.save('models/sketch_model.keras')  # Save in new format
